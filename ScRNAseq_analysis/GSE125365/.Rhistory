####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/MCF10/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/MCF10/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/Cook/output_dir/")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE17708/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime$patients
pseudotime$Timepoint <- c(rep(0,3),rep(0.5,3), rep(1,3),rep(2,2),rep(4,3),rep(8,3),rep(16,3),rep(24,3),rep(72,3))
colnames(pseudotime)
pseudotime$Timepoint <- factor(pseudotime$Timepoint, levels = c(0,0.5,1,2,4,8,16,24,72))
pseudotime$Rep <- c(1,2,3,1,2,3,1,2,3,1,2,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3)
pseudotime$Rep <- factor(pseudotime$Rep, levels = c(1,2,3))
pdf("Timepoint_vs_pseudotime.pdf",height = 4,width = 8)
ggplot(pseudotime, aes(x=Timepoint, y=mock, shape = Rep, color = Rep)) +
geom_point() + xlab("Timepoint (hours)") + ylab("Pseudotime") + theme_classic()
dev.off()
pdf("GSE17708_timepoint_vs_pseudotime.pdf",height = 4,width = 8)
ggplot(pseudotime, aes(x=Timepoint, y=mock, shape = Rep, color = Rep)) +
geom_point() + xlab("Timepoint (hours)") + ylab("Pseudotime") + theme_classic()
dev.off()
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE57872/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE57872/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE57872/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
View(pseudotime)
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep1/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep1/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep1/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep1/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime$Timepoint <- c(0,6,12,24,36,48,72,96)
pdf("GSE69667_rep1_timepoint_vs_pseudotime.pdf",height = 5,width = 5)
ggplot(pseudotime, aes(x=Timepoint, y=mock)) +
geom_point() + xlab("Timepoint (hours)") + ylab("Pseudotime") + theme_classic()
dev.off()
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep2/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep2/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep2/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE69667_rep2/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime$Timepoint <- c(0,6,12,24,36,48,72,96)
pdf("GSE69667_rep2_timepoint_vs_pseudotime.pdf",height = 5,width = 5)
ggplot(pseudotime, aes(x=Timepoint, y=mock)) +
geom_point() + xlab("Timepoint (hours)") + ylab("Pseudotime") + theme_classic()
dev.off()
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75487/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75487/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75487/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75487/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime$Timepoint <- c(0,1,2,3,4,5,6,7)
pdf("GSE75487_timepoint_vs_pseudotime.pdf",height = 5,width = 5)
ggplot(pseudotime, aes(x=Timepoint, y=mock)) +
geom_point() + xlab("Timepoint (days)") + ylab("Pseudotime") + theme_classic()
dev.off()
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE84135/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE84135/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE84135/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE84135/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime <- pseudotime[1:9,]
pseudotime$Timepoint <- c(0,0,0,1,1,1,3,3,3)
pseudotime$Timepoint <- factor(pseudotime$Timepoint, levels = c(0,1,3))
pdf("GSE84135_timepoint_vs_pseudotime.pdf",height = 5,width = 5)
ggplot(pseudotime, aes(x=Timepoint, y=mock)) +
geom_point() + xlab("Timepoint (days)") + ylab("Pseudotime") + theme_classic()
dev.off()
####Pseudotime mid confidence
#Load MCF10 pseudotime estimates
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE125365/MCF10/output_dir/")
pseudotime <- read.table("proj_pseudospace_withzeros.txt", header = TRUE,sep = "\t")
pseudotime$mock <- pseudotime$mock + pseudotime$tgfb
conditions <- c("A549_TGFB1","A549_TNF","DU145_TGFB1","DU145_TNF",
"MCF7_TGFB1","MCF7_TNF","OVCA420_TGFB1","OVCA420_TNF")
for (i in conditions) {
print(i)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE125365/Cook/output_dir/")
pseudotime_add <- read.table(paste("KNN_projection_TCGA_to_",i,"_treated_cells_no_correction_primarytumor.txt",sep = ''), header = TRUE,sep = "\t")
print(all(pseudotime$patients == pseudotime_add$patients))
pseudotime$mock <- pseudotime$mock + pseudotime_add$pseudospace
}
summary(pseudotime$mock)
pseudotime$mock <- pseudotime$mock / 10
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE125365/")
write.table(pseudotime, "AveragedPseudotime_midconf_withzeros.txt",row.names=F,quote=F,sep="\t")
##############################
#Pseudotime across timepoints
library(ggplot2)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE125365/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime$Timepoint <- c(0,0,1,1,2,2,4,4,6,6,168,168,8,8,18,18,500,500,24,24,72,72,4500,4500)
pseudotime$Timepoint <- factor(pseudotime$Timepoint, levels = c(0,1,2,4,6,8,18,24,72,168,500,4500))
pdf("GSE125365_timepoint_vs_pseudotime.pdf",height = 4,width = 8)
ggplot(pseudotime, aes(x=Timepoint, y=mock)) +
geom_point() + xlab("Timepoint (hours)") + ylab("Pseudotime") + theme_classic()
dev.off()
View(pseudotime)
