#Load required packages:
library(reshape)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/Qian_Breast/CellphoneDb/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/Qian_Breast/CellphoneDb/BreastCancerOut/")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
library(ggplot2)
#Boxplot summary
pdf("InteractionNumber.pdf",height = 5,width = 5)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType) + theme_classic()
dev.off()
#Load required packages:
library(reshape)
library(ggplot2)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianBreast/CellphoneDb/Input/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianBreast/CellphoneDb/Input/out/")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
#Boxplot summary
pdf("BRCAcohort_InteractionNumberSummary.pdf",height = 5,width = 10)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType, nrow = 1) + theme_classic() + ylab("Total Number of Interactions with Cancer Cells") + xlab("Pseudotime Status")
dev.off()
#Load required packages:
library(reshape)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianColorectal/CellphoneDb/Input/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianColorectal/CellphoneDb/Input/out/")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
library(ggplot2)
#Boxplot summary
pdf("ColorectalCohort_InteractionNumberSummary.pdf",height = 5,width = 10)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType, nrow = 1) + theme_classic() + ylab("Total Number of Interactions with Cancer Cells") + xlab("Pseudotime Status")
dev.off()
#Load required packages:
library(reshape)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianLung/CellphoneDb/Input/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianLung/CellphoneDb/Input/out/")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
library(ggplot2)
#Boxplot summary
pdf("LungCohort_InteractionNumberSummary.pdf",height = 5,width = 10)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType, nrow = 1) + theme_classic() + ylab("Total Number of Interactions with Cancer Cells") + xlab("Pseudotime Status")
dev.off()
#Load required packages:
library(reshape)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianOvary/CellphoneDb/Input/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/QianOvary/CellphoneDb/Input/out/")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
library(ggplot2)
#Boxplot summary
pdf("OvarianCohort_InteractionNumberSummary.pdf",height = 5,width = 10)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType, nrow = 1) + theme_classic() + ylab("Total Number of Interactions with Cancer Cells") + xlab("Pseudotime Status")
dev.off()
#Load required libraries
library(CellChat)
library(patchwork)
options(stringsAsFactors = FALSE)
library(dplyr)
#Load data:
setwd("~/Documents/Dormancy_TME_project_data/scRNAseq/GSE75688/Expression/")
annotation <- read.table("GSE75688_final_sample_information.txt", header = TRUE,sep = "\t")
TPM.data <- read.table("GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix.txt",header = TRUE, sep = "\t")
##Reorganise the datafame:
TPM.data$gene_name <- as.character(TPM.data$gene_name)
TPM.data$gene_id <- NULL
TPM.data$gene_type <- NULL
TPM.data <- TPM.data %>% group_by(gene_name) %>% mutate_each(funs(mean)) %>% distinct
TPM.data <- data.frame(TPM.data)
rownames(TPM.data) <- TPM.data$gene_name
TPM.data$gene_name <- NULL
TPM.data <- as.matrix(TPM.data)
TPM.data <- log2(TPM.data + 1) #Data needs to be log-transformed
TPM.data <- data.frame(TPM.data)
#Select only primary tumour samples and samples which have not undergone chemotherapy:
annotation$sample <- as.character(annotation$sample)
annotation$patient.sample <- sapply(annotation$sample, function(x)
strsplit(x,"_")[[1]][1])
annotation$type <- as.character(annotation$type)
annotation <- annotation[annotation$type %in% "SC",]
annotation$Label <- annotation$index3
#Add quiescence score annotation:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75688/01_Reconstruction_EMT_bulk/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime <- pseudotime[order(pseudotime$mock),]
split_pseudotime <- split(pseudotime, rep(1:3, length.out = nrow(pseudotime), each = ceiling(nrow(pseudotime)/3)))
pseudotime_low <- split_pseudotime[[1]]
pseudotime_mid <- split_pseudotime[[2]]
pseudotime_high <- split_pseudotime[[3]]
pseudotime_low <- as.character(pseudotime_low$patients)
pseudotime_mid <- as.character(pseudotime_mid$patients)
pseudotime_high <- as.character(pseudotime_high$patients)
annotation_normal <- annotation[annotation$index %in% "nonTumor",]
annotation_tumour <- annotation[annotation$index %in% "Tumor",]
#Identify quiescent samples
annotation_tumour$Label <- sapply(annotation_tumour$sample, function(x)
ifelse(x %in% pseudotime_low, "LowPseudotime_tumour",
ifelse(x %in% pseudotime_high, "HighPseudotime_tumour",
ifelse(x %in% pseudotime_mid, "MidPseudotime_tumour","Other"))))
annotation <- rbind(annotation_normal, annotation_tumour)
TPM.data <- TPM.data[,colnames(TPM.data) %in% annotation$sample]
rownames(annotation) <- annotation$sample
all(rownames(annotation) == colnames(TPM.data))
TPM.data <- TPM.data[,order(colnames(TPM.data))]
annotation <- annotation[order(rownames(annotation)),]
all(rownames(annotation) == colnames(TPM.data))
TPM.data[1:10,1:10]
annotation[1:7,1:7]
#####################
#CellChat - GSE75688
####################
#Load required libraries
library(CellChat)
library(patchwork)
options(stringsAsFactors = FALSE)
library(dplyr)
############################################################################
#PART I: Data input and processing and initialization of the CellChat object
############################################################################
#Load data:
setwd("~/Documents/Dormancy_TME_project_data/scRNAseq/GSE75688/Expression/")
annotation <- read.table("GSE75688_final_sample_information.txt", header = TRUE,sep = "\t")
TPM.data <- read.table("GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix.txt",header = TRUE, sep = "\t")
##Reorganise the datafame:
TPM.data$gene_name <- as.character(TPM.data$gene_name)
TPM.data$gene_id <- NULL
TPM.data$gene_type <- NULL
TPM.data <- TPM.data %>% group_by(gene_name) %>% mutate_each(funs(mean)) %>% distinct
TPM.data <- data.frame(TPM.data)
rownames(TPM.data) <- TPM.data$gene_name
TPM.data$gene_name <- NULL
TPM.data <- as.matrix(TPM.data)
TPM.data <- log2(TPM.data + 1) #Data needs to be log-transformed
TPM.data <- data.frame(TPM.data)
#Select only primary tumour samples and samples which have not undergone chemotherapy:
annotation$sample <- as.character(annotation$sample)
annotation$patient.sample <- sapply(annotation$sample, function(x)
strsplit(x,"_")[[1]][1])
annotation$type <- as.character(annotation$type)
annotation <- annotation[annotation$type %in% "SC",]
annotation$Label <- annotation$index3
#Add quiescence score annotation:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75688/01_Reconstruction_EMT_bulk/")
pseudotime <- read.table("AveragedPseudotime_midconf_withzeros.txt", header = TRUE, sep = "\t")
pseudotime <- pseudotime[order(pseudotime$mock),]
split_pseudotime <- split(pseudotime, rep(1:3, length.out = nrow(pseudotime), each = ceiling(nrow(pseudotime)/3)))
pseudotime_low <- split_pseudotime[[1]]
pseudotime_mid <- split_pseudotime[[2]]
pseudotime_high <- split_pseudotime[[3]]
pseudotime_low <- as.character(pseudotime_low$patients)
pseudotime_mid <- as.character(pseudotime_mid$patients)
pseudotime_high <- as.character(pseudotime_high$patients)
annotation_normal <- annotation[annotation$index %in% "nonTumor",]
annotation_tumour <- annotation[annotation$index %in% "Tumor",]
#Identify quiescent samples
annotation_tumour$Label <- sapply(annotation_tumour$sample, function(x)
ifelse(x %in% pseudotime_low, "LowPseudotime_tumour",
ifelse(x %in% pseudotime_high, "HighPseudotime_tumour",
ifelse(x %in% pseudotime_mid, "MidPseudotime_tumour","Other"))))
annotation <- rbind(annotation_normal, annotation_tumour)
table(annotation$Label)
TPM.data <- TPM.data[,colnames(TPM.data) %in% annotation$sample]
rownames(annotation) <- annotation$sample
all(rownames(annotation) == colnames(TPM.data))
TPM.data <- TPM.data[,order(colnames(TPM.data))]
annotation <- annotation[order(rownames(annotation)),]
all(rownames(annotation) == colnames(TPM.data))
TPM.data <- as.matrix(TPM.data) #Ultimate format is a matrix with samples as colnames and genes as rownames
###Format for Cellphonedb:
Gene <- rownames(TPM.data)
Gene <- data.frame(Gene)
TPM.data <- cbind(Gene, TPM.data)
rownames(TPM.data) <- NULL
annotation <- annotation[,colnames(annotation) %in% c("sample","Label")]
colnames(annotation) <- c("Cell","cell_type")
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75688/CellphoneDb/Input/")
#Save:
write.table(annotation, file = "test_meta.txt", quote = FALSE, sep = "\t", row.names = FALSE, col.names = TRUE)
write.table(TPM.data, file = "test_counts.txt", quote = FALSE, sep = "\t", row.names = FALSE, col.names = TRUE)
#Load metadata to see how many cells are in the differnet categories:
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75688/CellphoneDb/Input/")
meta.data <- read.table("test_meta.txt", header = TRUE, sep = "\t")
table(meta.data$cell_type)
#Load interaction data
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/ScRNAseqAnalysis/GSE75688/CellphoneDb/Input/out")
df.net <- read.table("significant_means.txt", header = TRUE, sep = "\t")
df.net <- melt(df.net, id.vars = c("id_cp_interaction","interacting_pair","partner_a","partner_b","gene_a","gene_b","secreted","receptor_a","receptor_b","annotation_strategy","is_integrin","rank"))
#Check number of interactions
cell_types <- unique(as.character(meta.data$cell_type))
cell_types <- cell_types[!(cell_types %in% c("LowPseudotime_tumour","MidPseudotime_tumour","HighPseudotime_tumour"))]
Interaction_number <- NULL
for (i in cell_types) {
print(i)
df.net.low <- df.net[df.net$variable %in% c(paste(i,".LowPseudotime_tumour",sep = ""),paste("LowPseudotime_tumour.",i,sep = "")),]
df.net.low <- na.omit(df.net.low)
df.net.low <- dim(df.net.low)[1]
Interaction_number <- c(Interaction_number, df.net.low)
df.net.mid <- df.net[df.net$variable %in% c(paste(i,".MidPseudotime_tumour",sep = ""),paste("MidPseudotime_tumour.",i,sep = "")),]
df.net.mid <- na.omit(df.net.mid)
df.net.mid <- dim(df.net.mid)[1]
Interaction_number <- c(Interaction_number, df.net.mid)
df.net.high <- df.net[df.net$variable %in% c(paste(i,".HighPseudotime_tumour",sep = ""),paste("HighPseudotime_tumour.",i,sep = "")),]
df.net.high <- na.omit(df.net.high)
df.net.high <- dim(df.net.high)[1]
Interaction_number <- c(Interaction_number, df.net.high)
}
CellType <- NULL
for (i in cell_types) {
print(i)
CellType <- c(CellType, rep(i,3))
}
l <- length(cell_types)
PseudotimeStatus <- rep(c("Low","Mid","High"),l)
summary <- data.frame(CellType, PseudotimeStatus, Interaction_number)
summary$PseudotimeStatus <- factor(summary$PseudotimeStatus, levels = c("Low","Mid","High"))
#Boxplot summary
pdf("Chung2017_InteractionNumberSummary.pdf",height = 5,width = 10)
ggplot(summary, aes(x=PseudotimeStatus, y=Interaction_number)) +
geom_bar(stat = "identity") +  facet_wrap(.~CellType, nrow = 1) + theme_classic() + ylab("Total Number of Interactions with Cancer Cells") + xlab("Pseudotime Status")
dev.off()
