setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/Data")
cds.list <- readRDS("pseudospace_processed_trajectories_cds.list.rds")
mock <- Biobase::exprs(cds.list[["Mock"]])
mock_genes<-cds.list[["Mock"]]@featureData@data[,c(1,2)]
mock2<-data.frame(genes=mock_genes,as.matrix(mock))
mock_pData <- pData(cds.list[["Mock"]])[,c("cell","sample","Pseudotime")]
mock_norm <- norm_expr_data(mock2[,-c(1:2)],1)
mock_norm2 <- data.frame(mock2[,c(1:2)],mock_norm)
library(data.table)
library('biomaRt')
library(phenopath)
library(openxlsx)
library(ggplot2)
library(FNN)
library(irlba)
library(sva)
library(factoextra)
library(monocle)
library(depmixS4)
setwd("~/Documents/EMT_paper_revision/TCGA_PurityScaledAnalysis/MCF10_Cook_averaged/01_Reconstruction_EMT_bulk/projection_EMT_tarjectory_CCLE/MCF10/data")
tab_input<-fread(file="CCLE_RNAseq_rsem_genes_tpm_20180929.txt",data.table=F)
#
# Step1: convert ensembl to gene-symbol
#
human = useMart("ensembl", dataset="hsapiens_gene_ensembl", host = "useast.ensembl.org")
tab_input[,1]<-sapply(strsplit(tab_input[,1],split="\\."),"[[",1)
genes <- unique(tab_input$gene_id)
gene_IDs<- getBM(attributes=c("ensembl_gene_id", "hgnc_symbol"), values=genes, mart=human, filters = "ensembl_gene_id")
View(gene_IDs)
save(gene_IDs, file = "gene_IDs.RData")
